generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-1.0.x", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "mongodb"
  url      = env("MONGODB_URI")
}

// ============ AUTH & USERS ============

model User {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  email        String   @unique
  password     String
  name         String
  role         String   @default("EDITOR")
  isActive     Boolean  @default(true)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  blogPosts    BlogPost[]
}

// ============ SERVICES ============

model ServiceCategory {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  slug        String    @unique
  description String?
  icon        String?
  order       Int       @default(0)
  isActive    Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  services    Service[]
}

model Service {
  id          String          @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  slug        String          @unique
  description String
  details     String?
  icon        String?
  image       String?
  features    String          @default("[]")
  order       Int             @default(0)
  isActive    Boolean         @default(true)
  categoryId  String          @db.ObjectId
  category    ServiceCategory @relation(fields: [categoryId], references: [id], onDelete: Cascade)
  createdAt   DateTime        @default(now())
  updatedAt   DateTime        @updatedAt
}

// ============ PORTFOLIO ============

model Project {
  id            String         @id @default(auto()) @map("_id") @db.ObjectId
  title         String
  slug          String         @unique
  description   String
  content       String?
  category      String
  client        String?
  duration      String?
  technologies  String         @default("[]")
  results       String?
  image         String?
  isFeatured    Boolean        @default(false)
  isActive      Boolean        @default(true)
  order         Int            @default(0)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  images        ProjectImage[]
}

model ProjectImage {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  url       String
  alt       String?
  order     Int      @default(0)
  projectId String   @db.ObjectId
  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
}

// ============ BLOG ============

model BlogPost {
  id          String       @id @default(auto()) @map("_id") @db.ObjectId
  title       String
  slug        String       @unique
  excerpt     String
  content     String
  image       String?
  status      String       @default("DRAFT")
  publishedAt DateTime?
  scheduledAt DateTime?
  metaTitle   String?
  metaDesc    String?
  keywords    String       @default("[]")
  readTime    String?
  authorId    String       @db.ObjectId
  author      User         @relation(fields: [authorId], references: [id])
  categoryId  String?      @db.ObjectId
  category    BlogCategory? @relation(fields: [categoryId], references: [id])
  tagIds      String[]     @db.ObjectId
  tags        BlogTag[]    @relation(fields: [tagIds], references: [id])
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
}

model BlogCategory {
  id        String     @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  slug      String     @unique
  posts     BlogPost[]
  createdAt DateTime   @default(now())
}

model BlogTag {
  id    String     @id @default(auto()) @map("_id") @db.ObjectId
  name  String     @unique
  slug  String     @unique
  postIds String[] @db.ObjectId
  posts BlogPost[] @relation(fields: [postIds], references: [id])
}

// ============ TESTIMONIALS ============

model Testimonial {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  role      String
  company   String?
  content   String
  rating    Int      @default(5)
  image     String?
  isActive  Boolean  @default(true)
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ============ TEAM ============

model TeamMember {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  role      String
  bio       String?
  image     String?
  linkedin  String?
  github    String?
  twitter   String?
  order     Int      @default(0)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ============ LEADS / CONTACTS ============

model Lead {
  id        String     @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  email     String
  phone     String?
  company   String?
  service   String?
  message   String
  status    String     @default("NEW")
  source    String?    @default("website")
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
}

// ============ NEWSLETTER ============

model NewsletterSubscriber {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  email     String   @unique
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
}

// ============ FAQ ============

model FAQ {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  question  String
  answer    String
  category  String?
  order     Int      @default(0)
  isActive  Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// ============ SITE SETTINGS ============

model SiteSetting {
  id    String @id @default(auto()) @map("_id") @db.ObjectId
  key   String @unique
  value String
  type  String @default("text")
}

// ============ SEO META ============

model SeoMeta {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  page        String   @unique
  title       String?
  description String?
  keywords    String   @default("[]")
  ogImage     String?
  schema      String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}

// ============ MEDIA ============

model Media {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  filename  String
  url       String
  mimetype  String
  size      Int
  alt       String?
  createdAt DateTime @default(now())
}

// ============ PAGE SECTIONS ============

model PageSection {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  page      String
  section   String
  isVisible Boolean  @default(true)
  order     Int      @default(0)
  content   String?
  updatedAt DateTime @updatedAt

  @@unique([page, section])
}
